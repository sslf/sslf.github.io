---
layout: post
title: java日志体系
category: Java
#permalink: /java/log.html
---
在工作中，我们可以接触到很多的日志jar包，比如：java.util.logging、log4j、log4j2、logback、slf4j等等。那我们应该怎么使用呢？

### 一、日志分类和作用关系
![日志关系](http://ozsqtghjh.bkt.clouddn.com/b440fd2a566cf6df1fff7e6d1b5307dd.png)

日志门面的说明：
我们常用的门面有两个，一个是apache的common-logging-api简称：**jcl**。另外一个是：slf4j-api 简称 **slf4j**。  

### 二、常用门面的区别
他们的区别在于：jcl是检测classpath下存在什么日志就用什么日志。slf4j需要手动的添加适配器包到classpath下，也就是手动设置要用到的日志。

### 三、日志的嫁接
现在我们通常使用的是slf4j，同时也使用了spring。但是spring使用的是jcl门面。所有就需要做日志的嫁接了。如果不做的话，spring的日志我们是无法打印的。除非再给spring专门配一个日志打印。
怎么嫁接呢？
1. 从classpath中移除之前的日志实现。
2. 在classpath中引入一个叫：jcl-over-slf4j的jar包。

嫁接之后，spring日志具体的执行流程就变成这样了（实线箭头方向）：
![jcl-over-slf4j](http://ozsqtghjh.bkt.clouddn.com/b16f19a2d5fb1061026916e675f959d3.png)

同样，想把slf4j嫁接到jcl，只需要移除之前的适配器，然后引入sl4j-jcl就可以了。

上面说的都是从一个门面嫁接到另一个门面。当然，从一个具体的日志实现，同样也是可以嫁接到日志门面的。比如：把log4j嫁接到slf4j上，只需要引入log4j-over-slf4j。

### 四、循环引用的问题
这个问题是会引发**栈溢出**（StackOverflowError），具体是什么一个情况呢。如下图：
![栈溢出](http://ozsqtghjh.bkt.clouddn.com/cc58213747bae479e850dd8a8db504cb.png)

本来slf4j就是用的log4j来打印日志的，结果又加入了log4j嫁接到slf4j上的jar包。所以也就发生了循环。
