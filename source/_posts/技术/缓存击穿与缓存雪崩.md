---
title: 缓存击穿与缓存雪崩
date: 2019-2-21 10:30:44
category: 技术
id: e211afaa-b668-50df-81f9-771a027d2dec
---
全世界的程序猿都知道，在应对大流量、数据库的频繁查询的时候，由于数据库是承受不住的，所以一般都是在数据库的上方做一个缓存，也就是所谓的缓存层。
不过，你有没有想过，如果缓存失效了怎么办，全都走数据库查询，那数据库不就gg了吗。

什么？缓存会失效，我不信。好吧，那我就说说缓存失效的场景吧。

#### 场景一
数据库里打死都不会出现xxx信息，突然有一天，有一大波流量在查询xxx。由于数据库没有数据，理所当然在上方的缓存里也没有缓存该数据，
缓存里没有，那就必须查询数据库了呀，可是数据库又承受不住这么大的流量。所以该数据库就gg了。—— 缓存击穿

#### 场景二
数据库里也有数据，同时缓存也缓存了该数据。巧了，热点数据同时大面积失效了。也就是同一时间过期了。相当于没有了缓存，和场景一一样，
全部流量都又去到了数据库了。此时数据库正在承受着不该承受的压力。—— 缓存雪崩

缓存击穿造成的原因：查询缓存了压根就不会存在的值；而缓存雪崩的原因是：同一时间大面积缓存数据失效。那有没有什么应对方法呢？答案可定是有的。
具体的方案如下。

应对缓存击穿的方案如下：
1. 不是查询了数据库压根就没有的值嘛，只要我们把没有的值也缓存起来，不就可以嘛。比如 数据库返回null，在缓存里也缓存null就可以了。
1. 布隆过滤器
1. 流量控制

应对缓存雪崩的方案如下：
1. 设置随机过期时间
1. 增加多级缓存
1. 流量控制

我要说的就写完了，如有补充，请不吝赐教。